# Deployed model for YOLOX_opt-S-TrafficLight x2/1.X.Y
## Summary

- Performance summary
  - Evaluation dataset: Eval dataset of TLR v1.0 + TLR v4.0
  - mAP, AP for IOUs (50, 60, 70, 80, 90)

|                    | mAP        | AP50       | AP60       | AP70       | AP80       | AP90       |
| ------------------ | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
| base/1.0(baseline) | 0.3588     | 0.4810     | 0.4760     | 0.4520     | 0.3250     | 0.0600     |
| x2/1.0.0           | **0.3636** | **0.4830** | **0.4780** | **0.4580** | **0.3360** | **0.0630** |


## Release

### x2/1.0.0

- [DB TLR v5.0](../../../../../autoware_ml/configs/t4dataset/db_tlr_v5.yaml) is used for training.

<details>
<summary> The link of data and evaluation result </summary>

- model
  - Training dataset: DB TLR v1.0, 2.0, 3.0, 4.0, 5.0
  - Eval dataset: DB TLR v1.0, 4.0, 5.0
  - [PR](https://github.com/tier4/autoware-ml/pull/355)
  - [Config file path](https://drive.google.com/file/d/1N-lrJyTW1FKEL7sGxMgMC4Zbm0G_DJ7i/view?usp=drive_link)
  - [Deployed onnx model](https://evaluation.tier4.jp/evaluation/mlpackages/ac288878-9790-44e3-9fc8-ca246c5cd235/releases/2283f3f1-a245-4d28-b991-b4ff5aee3fb7?project_id=zWhWRzei)
  - [Training results](https://drive.google.com/drive/folders/1BWEs1OgdfpFHF6Yu9Xe8JcvIDtu3KfyG)
  - train time: (NVIDIA A100-SXM4-80GB * 2) * 300 epochs = 28 hours

### Results evaluated with DB TLR v1.0, 4.0, 5.0

- Total mAP: 0.3561
  - Test dataset: DB TLR v1.0, 4.0, 5.0
  - Bbox size range: (0,inf)
  - [Evaluation results](https://drive.google.com/drive/folders/1XoR-sZ3VkvtPcH5-gBlCblP8BUI2axdX?usp=drive_link)

```sh
---------------iou_thr: 0.5---------------

+--------------------------+-------+-------+--------+-------+
| class                    | gts   | dets  | recall | ap    |
+--------------------------+-------+-------+--------+-------+
| BACKGROUND               | 0     | 0     | 0.000  | 0.000 |
| traffic_light            | 17950 | 18348 | 0.965  | 0.913 |
| pedestrian_traffic_light | 2193  | 2235  | 0.814  | 0.678 |
+--------------------------+-------+-------+--------+-------+
| mAP                      |       |       |        | 0.795 |
+--------------------------+-------+-------+--------+-------+

---------------iou_thr: 0.6---------------

+--------------------------+-------+-------+--------+-------+
| class                    | gts   | dets  | recall | ap    |
+--------------------------+-------+-------+--------+-------+
| BACKGROUND               | 0     | 0     | 0.000  | 0.000 |
| traffic_light            | 17950 | 18348 | 0.955  | 0.894 |
| pedestrian_traffic_light | 2193  | 2235  | 0.801  | 0.656 |
+--------------------------+-------+-------+--------+-------+
| mAP                      |       |       |        | 0.775 |
+--------------------------+-------+-------+--------+-------+

---------------iou_thr: 0.7---------------

+--------------------------+-------+-------+--------+-------+
| class                    | gts   | dets  | recall | ap    |
+--------------------------+-------+-------+--------+-------+
| BACKGROUND               | 0     | 0     | 0.000  | 0.000 |
| traffic_light            | 17950 | 18348 | 0.926  | 0.841 |
| pedestrian_traffic_light | 2193  | 2235  | 0.760  | 0.596 |
+--------------------------+-------+-------+--------+-------+
| mAP                      |       |       |        | 0.718 |
+--------------------------+-------+-------+--------+-------+

---------------iou_thr: 0.8---------------

+--------------------------+-------+-------+--------+-------+
| class                    | gts   | dets  | recall | ap    |
+--------------------------+-------+-------+--------+-------+
| BACKGROUND               | 0     | 0     | 0.000  | 0.000 |
| traffic_light            | 17950 | 18348 | 0.796  | 0.621 |
| pedestrian_traffic_light | 2193  | 2235  | 0.589  | 0.372 |
+--------------------------+-------+-------+--------+-------+
| mAP                      |       |       |        | 0.497 |
+--------------------------+-------+-------+--------+-------+

---------------iou_thr: 0.9---------------

+--------------------------+-------+-------+--------+-------+
| class                    | gts   | dets  | recall | ap    |
+--------------------------+-------+-------+--------+-------+
| BACKGROUND               | 0     | 0     | 0.000  | 0.000 |
| traffic_light            | 17950 | 18348 | 0.322  | 0.101 |
| pedestrian_traffic_light | 2193  | 2235  | 0.218  | 0.056 |
+--------------------------+-------+-------+--------+-------+
| mAP                      |       |       |        | 0.079 |
+--------------------------+-------+-------+--------+-------+

AP50: 0.4760  AP60: 0.4690  AP70: 0.4470  AP80: 0.3270  AP90: 0.0610  mAP: 0.3562  data_time: 0.0183  time: 0.3108
```

### Results evaluated with DB TLR v1.0, 4.0

If you want to compare the result of x2/1.0.0 with base/1.0, please use this evaluation result.

- Total mAP: 0.3636
  - Test dataset: DB TLR v1.0, 4.0
  - Bbox size range: (0,inf)
  - [Evaluation results](https://drive.google.com/drive/folders/1ObUG3Nz0ETBNwuLLdRDbdtIaKOCRanzU)

```sh
***************bbox range = (0, inf)***************
---------------iou_thr: 0.5---------------
+--------------------------+-------+-------+--------+-------+
| class                    | gts   | dets  | recall | ap    |
+--------------------------+-------+-------+--------+-------+
| BACKGROUND               | 0     | 0     | 0.000  | 0.000 |
| traffic_light            | 17623 | 18075 | 0.969  | 0.917 |
| pedestrian_traffic_light | 2007  | 1986  | 0.794  | 0.661 |
+--------------------------+-------+-------+--------+-------+
| mAP                      |       |       |        | 0.789 |
+--------------------------+-------+-------+--------+-------+
---------------iou_thr: 0.6---------------
+--------------------------+-------+-------+--------+-------+
| class                    | gts   | dets  | recall | ap    |
+--------------------------+-------+-------+--------+-------+
| BACKGROUND               | 0     | 0     | 0.000  | 0.000 |
| traffic_light            | 17623 | 18075 | 0.961  | 0.901 |
| pedestrian_traffic_light | 2007  | 1986  | 0.778  | 0.637 |
+--------------------------+-------+-------+--------+-------+
| mAP                      |       |       |        | 0.769 |
+--------------------------+-------+-------+--------+-------+
---------------iou_thr: 0.7---------------
+--------------------------+-------+-------+--------+-------+
| class                    | gts   | dets  | recall | ap    |
+--------------------------+-------+-------+--------+-------+
| BACKGROUND               | 0     | 0     | 0.000  | 0.000 |
| traffic_light            | 17623 | 18075 | 0.931  | 0.847 |
| pedestrian_traffic_light | 2007  | 1986  | 0.742  | 0.586 |
+--------------------------+-------+-------+--------+-------+
| mAP                      |       |       |        | 0.717 |
+--------------------------+-------+-------+--------+-------+
---------------iou_thr: 0.8---------------
+--------------------------+-------+-------+--------+-------+
| class                    | gts   | dets  | recall | ap    |
+--------------------------+-------+-------+--------+-------+
| BACKGROUND               | 0     | 0     | 0.000  | 0.000 |
| traffic_light            | 17623 | 18075 | 0.799  | 0.623 |
| pedestrian_traffic_light | 2007  | 1986  | 0.585  | 0.374 |
+--------------------------+-------+-------+--------+-------+
| mAP                      |       |       |        | 0.499 |
+--------------------------+-------+-------+--------+-------+
---------------iou_thr: 0.9---------------
+--------------------------+-------+-------+--------+-------+
| class                    | gts   | dets  | recall | ap    |
+--------------------------+-------+-------+--------+-------+
| BACKGROUND               | 0     | 0     | 0.000  | 0.000 |
| traffic_light            | 17623 | 18075 | 0.320  | 0.101 |
| pedestrian_traffic_light | 2007  | 1986  | 0.229  | 0.060 |
+--------------------------+-------+-------+--------+-------+
| mAP                      |       |       |        | 0.080 |
+--------------------------+-------+-------+--------+-------+

AP50: 0.4830  AP60: 0.4780  AP70: 0.4580  AP80: 0.3360  AP90: 0.0630  mAP: 0.3636  data_time: 0.0182  time: 0.1753
```

</details>
